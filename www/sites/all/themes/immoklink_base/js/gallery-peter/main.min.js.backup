if ("undefined" == typeof my) var my = {};
my.oldie = 1 === $("html.lt-ie9").length, my.useAddress = !0, my.useAddress = !my.oldie, my.clicked = !1, my.winWidth = $(window).width(), my.screenWidth = screen.width, my.slidesize = "big", my.screenWidth < 480 && (my.slidesize = "mobile"), my.slideDur = 400, my.animationInterval = 1700;
var $slideList = {}, sec_slug = "",
    gal_slug = "",
    img_id = "";
my.frag = {}, my.detachSlides = !0, my.detachSlides = 0 === $("html.ie9, html.lt-ie9").length, my.prevAnimated = "", $(document).ready(function() {
    if (my.useAddress) {
        var e = !0,
            i = "undefined" != typeof window.history.pushState;
        $.address.state("/").init(function() {
            $("body").on("click", ".main-nav a:not(.no-state), a.grid-item, a.logo, .sub-nav a:not(.no-state)", function(e) {
                e.preventDefault(), $.address.value($(this).attr("href"))
            })
        }).change(function(t) {
            if (i && e) {
                e = !1;
                var n = window.location.pathname;
                $.address.path(n)
            } else sec_slug = "", gal_slug = "", img_id = "", "undefined" != typeof t.pathNames[0] && (sec_slug = t.pathNames[0]), "undefined" != typeof t.pathNames[1] && (gal_slug = t.pathNames[1]), "undefined" != typeof t.pathNames[2] && (img_id = t.pathNames[2]), "" !== img_id ? (my.img_id = img_id, my.sec_slug = sec_slug, my.gal_slug = gal_slug, "image" !== my.view && (my.view = "image", my.imageView()), my.img_id !== img_id) : "" !== gal_slug ? (my.view = "gallery", my.gal_slug = gal_slug, my.sec_slug = sec_slug, my.galleryView()) : "info" === sec_slug ? (my.img_id = "", my.sec_slug = sec_slug, my.gal_slug = "", my.view = "image", my.imageView()) : ("section" !== my.view || my.sec_slug !== sec_slug) && (my.sec_slug = sec_slug, my.homeFlag = "" !== sec_slug ? !1 : !0, my.view = "section", my.sectionView())
        })
    }
    Modernizr.touch && $("div.content.slides").swipe({
        swipeLeft: my.next,
        swipeRight: my.prev,
        threshold: 25
    }), $("body").on("click", ".share", my.sharePanel), $("body").on("click", ".slide-wrap a.no-state, .section-info .slide-wrap", function(e) {
        e.stopPropagation()
    }), $("body").on("click", ".slide-wrap", my.slideClick), $("body").on("keyup", my.keyUp), my.windowResizeSlides(), my.viewSwitch(), $(".social").tooltipster({
        arrow: !1,
        delay: 0,
        position: "top-left",
        contentAsHTML: !0,
        interactive: !0,
        functionReady: function(e, i) {
            my.timeoutID = window.setTimeout(my.updateTooltip, my.tootipDelay)
        },
        content: $("<a h='https://uk.linkedin.com/pub/peter-guenzel/7/51/ab1'>LINKEDIN</a><a h='https://instagram.com/peterguenzel'>INSTAGRAM</a>")
    }), my.tootipDelay = 0, $("html.touch").length && (my.tootipDelay = 500)
}), my.updateTooltip = function() {
    $(".tooltipster-content").find("a").each(function() {
        $(this).attr("href", $(this).attr("h")), $(this).removeAttr("h")
    })
}, my.viewSwitch = function() {
    switch (window.clearTimeout(my.interval), $("body").removeClass().addClass("section-" + my.sec_slug), my.view) {
        case "section":
        case "gallery":
            my.fadeInOnLoad(), my.animateGridPrepare();
            break;
        case "image":
            my.fadeInOnLoad(), my.initOnLoadSlides()
    }
}, my.sectionView = function() {
    $("div.content").html(""), $(".main-nav").find(".current").removeClass("current"), "" !== my.sec_slug && $(".main-nav").find("." + my.sec_slug).addClass("current"), $(".sub-nav").html("<span class='sub-nav-item'>photography</span>"), $.ajax({
        url: "/_grid_section.php",
        dataType: "json",
        type: "GET",
        data: {
            view: my.view,
            sec_slug: my.sec_slug,
            screen_width: my.screenWidth,
            cache: my.cache
        }
    }).done(function(e) {
        $("div.grid.content").html(e.html), my.animImages = e.animImages, my.viewSwitch()
    }).fail(function(e, i) {})
}, my.galleryView = function() {
    $("div.content").html(""), $(".main-nav").find(".current").removeClass("current"), "" !== my.sec_slug && $(".main-nav").find("." + my.sec_slug).addClass("current"), $.ajax({
        url: "/_menu_sub.php",
        dataType: "json",
        type: "GET",
        data: {
            view: my.view,
            sec_slug: my.sec_slug,
            gal_slug: my.gal_slug,
            cache: my.cache
        }
    }).done(function(e) {
        $(".sub-nav").html(e.html)
    }).fail(function(e, i) {}), $.ajax({
        url: "/_grid_gallery.php",
        dataType: "json",
        type: "GET",
        data: {
            view: my.view,
            sec_slug: my.sec_slug,
            gal_slug: my.gal_slug,
            screen_width: my.screenWidth,
            cache: my.cache
        }
    }).done(function(e) {
        $(".grid.content").html(e.html), my.viewSwitch()
    }).fail(function(e, i) {})
}, my.imageView = function() {
    my.frag = {}, $("div.content").html(""), $("div.content.slides").html('<div class="slide-wrap"><ul class="slide-list init"><li></li></ul></div>'), $(".main-nav").find(".current").removeClass("current").end().find("." + my.sec_slug).addClass("current"), $.ajax({
        url: "/_menu_sub.php",
        dataType: "json",
        type: "GET",
        data: {
            view: my.view,
            sec_slug: my.sec_slug,
            gal_slug: my.gal_slug,
            cache: my.cache
        }
    }).done(function(e) {
        $(".sub-nav").html(e.html)
    }).fail(function(e, i) {}), $.ajax({
        url: "/_slides.php",
        dataType: "json",
        type: "GET",
        data: {
            view: my.view,
            sec_slug: my.sec_slug,
            gal_slug: my.gal_slug,
            img_id: my.img_id,
            slidesize: my.slidesize,
            screen_width: my.screenWidth,
            cache: my.cache
        }
    }).done(function(e) {
        my.slideCount = parseInt(e.slide_count), my.slide = parseInt(e.img), $(".slides.content").html(e.html), my.viewSwitch()
    }).fail(function(e, i) {})
}, my.animateGridPrepare = function() {
    return window.clearTimeout(my.interval), "undefined" != typeof my.animImages && my.animImages.length ? (my.animCount = 0, void(my.interval = window.setTimeout(my.animateGrid, my.animationInterval))) : !1
}, my.animateGrid = function() {
    window.clearTimeout(my.interval), $(".grid-item .anim").remove();
    for (var e = Math.floor(Math.random() * my.animImages.length); my.animImages[e].el === my.prevAnimated && my.animImages.length > 1;) e = Math.floor(Math.random() * my.animImages.length);
    if (my.animCount = e, my.prevAnimated = my.animImages[e].el, "undefined" == typeof my.animImages || "undefined" == typeof my.animImages[my.animCount]) return window.clearTimeout(my.interval), !1;
    $target = $(my.animImages[my.animCount].el);
    var i = my.animImages[my.animCount].path;
    if (my.animImages[my.animCount].path === $target.attr("src")) return my.animateGrid(), !1;
    var t = $("<img>").attr({
        "class": "anim",
        src: i
    });
    $target.after(t), t.imagesLoaded(function(e, n, a) {
        t.animate({
            opacity: 1
        }, 1e3, function() {
            $target.attr({
                src: i
            }), t.remove(), my.interval = window.setTimeout(my.animateGrid, my.animationInterval)
        })
    })
}, my.waitForFinalEvent = function() {
    var e = {};
    return function(i, t, n) {
        n || (n = "Don't call this twice without a uniqueId"), e[n] && clearTimeout(e[n]), e[n] = setTimeout(i, t)
    }
}(), my.fadeInOnLoad = function() {
    $("img.fade-me-in").each(function() {
        $(this).imagesLoaded(function(e, i, t) {
            Modernizr.csstransitions ? (i.addClass("fade-in").removeClass("fade-me-in"), window.setTimeout(function() {
                i.removeClass("fade-in").parent().addClass("loaded")
            }, 500)) : i.css({
                opacity: 0
            }).removeClass("fade-me-in").animate({
                opacity: 1
            }, "400", function() {
                $(this).removeAttr("style").parent().addClass("loaded")
            })
        })
    })
}, my.initOnLoadSlides = function() {
    $(".init-on-load img").imagesLoaded(function(e, i, t) {
        my.slideGo(!1)
    })
}, my.slideClick = function(e) {
    e.clientX <= .5 * my.winWidth ? my.prev() : e.clientX > .5 * my.winWidth && my.next()
}, my.prev = function() {
    my.clicked = !0, 0 !== my.slide && my.slide--, my.slideGo()
}, my.next = function() {
    my.clicked = !0, my.slide < my.slideCount - 1 ? (my.slide++, my.slideGo()) : (my.slide = 0, my.slideGo())
};
var $targetSlide;
my.slideGo = function(e) {
    if (my.oldie) return !1;
    var i, t, n = {}, a = my.slideDur,
        s = !1;
    "undefined" != typeof e && e === !1 && (a = 1), $slideList = $("#slide-list"), $slideList.find(".slide").each(function() {
        i = $(this), i.width(i.find(".slide-img").width() + "px"), t = i.data("slide"), t > 1 && (t < my.slide - 2 || t > my.slide + 2) && (my.frag[t] = i.removeClass("current").removeAttr("style").detach())
    }), $slideList.find(".current, .share-panel").removeClass("current share-panel "), $prev = $slideList.find(".slide" + (my.slide - 1)), $current = $slideList.find(".slide" + my.slide).addClass("current"), $next = $slideList.find(".slide" + (my.slide + 1)), $prevAll = $prev.prevAll(), $nextAll = $next.nextAll();
    var m = .05 * my.winWidth;
    currleft = my.winWidth / 2 - $current.width() / 2, $current.animate({
        left: currleft,
        leaveTransforms: !0,
        avoidTransforms: s
    }, a, function() {
        var e = $("#slide-list");
        if (e.removeClass("init"), my.detachSlides) {
            var i, t;
            $.each(my.frag, function(t, a) {
                i = $(this), t = i.data("slide"), t >= my.slide - 2 && t <= my.slide + 2 && 0 === e.find(".slide" + t).length && (n = t < my.slide ? {
                    transform: "translate(-" + my.winWidth + "px, 0px)"
                } : {
                    transform: "translate(" + 2 * my.winWidth + "px, 0px)"
                }, e.find(".slide" + (t - 1)).length ? e.find(".slide" + (t - 1)).after(a.css(n)) : e.find(".slide" + (t + 1)).length && e.find(".slide" + (t + 1)).before(a.css(n)))
            })
        }
        my.clicked && my.updateImgState($current.data("img_id"))
    }), $prev.animate({
        left: m - $prev.width(),
        leaveTransforms: !0,
        avoidTransforms: s
    }, a), $next.animate({
        left: my.winWidth - m,
        leaveTransforms: !0,
        avoidTransforms: s
    }, a), $prevAll.animate({
        left: 0 - my.winWidth,
        leaveTransforms: !0,
        avoidTransforms: s
    }, 1), $nextAll.animate({
        left: 2 * my.winWidth,
        leaveTransforms: !0,
        avoidTransforms: s
    }, 1)
}, my.updateImgState = function(e) {
    if (my.useAddress && "info" !== my.sec_slug) {
        var i = $.address.pathNames();
        i[2] = e, "image" === my.view && i.length < 3, $.address.path(i.join("/"))
    }
}, my.windowResizeSlides = function() {
    $(window).resize(function() {
        my.waitForFinalEvent(function() {
            my.winWidth = $(window).width(), "image" === my.view && my.slideGo()
        }, 300, "some unique string")
    })
}, my.keyUp = function(e) {
    var i = e.keyCode,
        t = {
            left: 37,
            up: 38,
            right: 39,
            down: 40,
            escape: 27
        };
    switch (i) {
        case t.left:
            my.prev();
            break;
        case t.right:
            my.next();
            break;
        case t.escape:
            $("a.all").length ? $("a.all").click() : $(".main-nav a.current").length && "section" !== my.view && my.homeFlag === !1 ? $("a.current").click() : $(".logo").click()
    }
}, my.sharePanel = function(e) {
    e.preventDefault(), $(".slides.content .current").length && $(".slides.content .current").toggleClass("share-panel")
};
